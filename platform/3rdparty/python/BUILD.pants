python_requirements(
    name="3rdparty",
    overrides={
        "pex": {"dependencies": [":3rdparty#setuptools"]},
        "ray": {"dependencies": [":3rdparty#setuptools"]},
        "sqlalchemy": {"dependencies": [":3rdparty#psycopg2-binary"]},
    },
    resolve="python_default",
    source="pyproject.toml",
)

shell_sources(name="shell-scripts")

files(
    name="lockfile",
    sources=["python_default.lock"],
)

run_shell_command(
    name="make_requirements_file",
    command="./convert_pants_lockfile_to_pip.sh ./python_default.lock requirements.txt",
    execution_dependencies=[
        ":shell-scripts",
        ":lockfile",
    ],
    workdir=".",
)
